!function(){"use strict";var a=["html","json","jsonp","script"],b=["connect","delete","get","head","options","patch","post","put","trace"],c=function a(){var b={},c={},f={url:function(a){return h.call(this,"url",a,d.string)},sync:function(a){return h.call(this,"sync",a,d.bool)},cache:function(a){return h.call(this,"cache",a,d.bool)},type:function(a){return h.call(this,"type",a,d.type)},header:function(a,c){return b.headers=b.headers||{},d.string(a),"undefined"!=typeof c?(d.string(c),b.headers[a]=c,this):b.headers[a]},auth:function(a,c){return d.string(a),d.string(c),b.auth={user:a,passwd:c},this},timeout:function(a){return h.call(this,"timeout",a,d.positiveInteger)},method:function(a){return h.call(this,"method",a,d.method)},queryString:function(a){return h.call(this,"queryString",a,d.queryString)},data:function(a){return h.call(this,"data",a,d.plainObject)},body:function(a){return h.call(this,"body",a,null,function(a){if("object"==typeof a){if(!(a instanceof FormData)){try{a=JSON.stringify(a)}catch(b){throw new TypeError("Unable to stringify body's content : "+b.name)}this.header("Content-Type","application/json")}}else a+="";return a})},into:function(a){return h.call(this,"into",a,d.selector,function(a){return"string"==typeof a?document.querySelectorAll(a):a instanceof HTMLElement?[a]:void 0})},jsonPaddingName:function(a){return h.call(this,"jsonPaddingName",a,d.string)},jsonPadding:function(a){return h.call(this,"jsonPadding",a,d.func)},on:function(a,b){return"function"==typeof b&&(c[a]=c[a]||[],c[a].push(b)),this},off:function(a){return c[a]=[],this},trigger:function(a,b){var d=this,e=function(a,b){c[a]instanceof Array&&c[a].forEach(function(a){a.call(d,b)})};if("undefined"!=typeof a){a+="";var f=/^([0-9])([0-9x])([0-9x])$/i,g=a.match(f);g&&g.length>3?Object.keys(c).forEach(function(a){var c=a.match(f);!(c&&c.length>3&&g[1]===c[1])||"x"!==c[2]&&g[2]!==c[2]||"x"!==c[3]&&g[3]!==c[3]||e(a,b)}):c[a]&&e(a,b)}return this},go:function(){var a=b.type||(b.into?"html":"json"),c=j();if("function"==typeof g[a])return g[a].call(this,c)}},g={json:function(a){var b=this;g._xhr.call(this,a,function(a){if(a)try{a=JSON.parse(a)}catch(c){return b.trigger("error",c),null}return a})},html:function(a){g._xhr.call(this,a,function(a){return b.into&&b.into.length&&[].forEach.call(b.into,function(b){b.innerHTML=a}),a})},_xhr:function(a,c){var d,e,f,g,h,j=this,k=b.method||"get",l=b.sync!==!0,m=new XMLHttpRequest,n=b.data,o=b.body,p=this.header("Content-Type"),q=b.timeout;if(!p&&n&&i()&&(this.header("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),p=this.header("Content-Type")),n&&i())if("string"!=typeof o&&(o=""),p.indexOf("json")>-1)try{o=JSON.stringify(n)}catch(r){throw new TypeError("Unable to stringify body's content : "+r.name)}else{g=p&&p.indexOf("x-www-form-urlencoded")>1;for(d in n)o+=g?encodeURIComponent(d)+"="+encodeURIComponent(n[d])+"&":d+"="+n[d]+"\n\r"}h=[k,a,l],b.auth&&(h.push(b.auth.user),h.push(b.auth.passwd)),m.open.apply(m,h);for(e in b.headers)m.setRequestHeader(e,b.headers[e]);m.onprogress=function(a){a.lengthComputable&&j.trigger("progress",a.loaded/a.total)},m.onload=function(){var a=m.responseText;f&&clearTimeout(f),this.status>=200&&this.status<300&&("function"==typeof c&&(a=c(a)),j.trigger("success",a)),j.trigger(this.status,a),j.trigger("end",a)},m.onerror=function(a){f&&clearTimeout(f),j.trigger("error",a,arguments)},q&&(f=setTimeout(function(){j.trigger("timeout",{type:"timeout",expiredAfter:q},m,arguments),m.abort()},q)),m.send(o)},jsonp:function(c){var d,f=this,g=document.querySelector("head"),h=b.sync!==!0,i=b.jsonPaddingName||"callback",j=b.jsonPadding||"_padd"+(new Date).getTime()+Math.floor(1e4*Math.random()),k={};if(a[j])throw new Error("Padding "+j+"  already exists. It must be unique.");/^ajajsonp_/.test(j)||(j="ajajsonp_"+j),window[j]=function(a){f.trigger("success",a),g.removeChild(d),window[j]=void 0},k[i]=j,c=e(c,k),d=document.createElement("script"),d.async=h,d.src=c,d.onerror=function(){f.trigger("error",arguments),g.removeChild(d),window[j]=void 0},g.appendChild(d)},script:function(a){var c,d=this,e=document.querySelector("head")||document.querySelector("body"),f=b.sync!==!0;if(!e)throw new Error("Ok, wait a second, you want to load a script, but you don't have at least a head or body tag...");c=document.createElement("script"),c.async=f,c.src=a,c.onerror=function(){d.trigger("error",arguments),e.removeChild(c)},c.onload=function(){d.trigger("success",arguments)},e.appendChild(c)}},h=function(a,c,e,f){if("undefined"!=typeof c){if("function"==typeof e)try{c=e.call(d,c)}catch(g){throw new TypeError("Failed to set "+a+" : "+g.message)}return"function"==typeof f?b[a]=f.call(this,c):b[a]=c,this}return"undefined"==typeof b[a]?null:b[a]},i=function(){return["delete","patch","post","put"].indexOf(b.method)>-1},j=function(){var a=b.url,c="undefined"==typeof b.cache||!!b.cache,d=b.queryString||"",f=b.data;return c===!1&&(d+="&ajabuster="+(new Date).getTime()),a=e(a,d),f&&!i()&&(a=e(a,f)),a};return f},d={bool:function(a){return!!a},string:function(a){if("string"!=typeof a)throw new TypeError("a string is expected, but "+a+" ["+typeof a+"] given");return a},positiveInteger:function(a){if(parseInt(a)!==a||a<=0)throw new TypeError("an integer is expected, but "+a+" ["+typeof a+"] given");return a},plainObject:function(a){if("object"!=typeof a||a.constructor!==Object)throw new TypeError("an object is expected, but "+a+"  ["+typeof a+"] given");return a},type:function(b){if(b=this.string(b),a.indexOf(b.toLowerCase())<0)throw new TypeError("a type in ["+a.join(", ")+"] is expected, but "+b+" given");return b.toLowerCase()},method:function(a){if(a=this.string(a),b.indexOf(a.toLowerCase())<0)throw new TypeError("a method in ["+b.join(", ")+"] is expected, but "+a+" given");return a.toLowerCase()},queryString:function(a){var b={};return"string"==typeof a?a.replace("?","").split("&").forEach(function(a){var c=a.split("=");2===c.length&&(b[decodeURIComponent(c[0])]=decodeURIComponent(c[1]))}):b=a,this.plainObject(b)},selector:function(a){if("string"!=typeof a&&!(a instanceof HTMLElement))throw new TypeError("a selector or an HTMLElement is expected, "+a+" ["+typeof a+"] given");return a},func:function(a){if(a=this.string(a),!/^([a-zA-Z_])([a-zA-Z0-9_\-])+$/.test(a))throw new TypeError("a valid function name is expected, "+a+" ["+typeof a+"] given");return a}},e=function(a,b){var c;if(a=a||"",b)if(a.indexOf("?")===-1&&(a+="?"),"string"==typeof b)a+=b;else if("object"==typeof b)for(c in b)/[?&]$/.test(a)||(a+="&"),a+=encodeURIComponent(c)+"="+encodeURIComponent(b[c]);return a};"function"==typeof window.define&&window.define.amd?window.define([],function(){return c}):"object"==typeof exports?module.exports=c:window.aja=window.aja||c}();